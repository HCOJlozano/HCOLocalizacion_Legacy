{
  "Queries": [
    {
      "QueryName": "CheckLastHourExecution",
      "Query": "SELECT (CASE WHEN \"U_HCO_LastTimeExec\" IS NULL THEN '1' WHEN IFNULL(ROUND(SECONDS_BETWEEN( TO_TIME((CASE WHEN LENGTH(\"U_HCO_LastTimeExec\") = 3 THEN TO_NVARCHAR(CONCAT('0',\"U_HCO_LastTimeExec\")) ELSE TO_NVARCHAR(\"U_HCO_LastTimeExec\") END),'HHMI'), ADD_SECONDS(CURRENT_TIME, -60))/60, 0),0) > \"U_HCO_TimeExec\" THEN '0' ELSE '1' END) AS \"Result\" FROM \"@HCO_TS0001\" WHERE \"Code\" = '{0}'"
    },
    {
      "QueryName": "GetMissingOperations",
      "Query": "SELECT ROW_NUMBER() OVER (ORDER BY \"DocEntry\") AS \"LineId\", 'Y' AS \"Seleccionar\", * FROM ( SELECT \"DocEntry\", \"DocNum\" AS \"Numero\", \"CardCode\", 'Factura Proveedor' AS \"Documento\", \"DocTotal\", \"ObjType\" AS \"DocType\", \"DocDate\" AS \"Fecha\"  FROM OPCH WHERE \"DocEntry\" NOT IN ( SELECT DISTINCT \"U_DocEntry\" FROM \"@HCO_WT1100\" WHERE \"U_DocType\" = 18) AND \"ObjType\"=18 AND \"DocEntry\" IN (SELECT DISTINCT \"AbsEntry\" FROM PCH5) UNION ALL SELECT \"DocEntry\", \"DocNum\" AS \"Numero\", \"CardCode\" AS \"Socio de Negocio\", 'NC Factura Proveedor' AS \"Documento\", \"DocTotal\", \"ObjType\" AS \"DocType\", \"DocDate\" AS \"Fecha\" FROM ORPC WHERE \"DocEntry\" NOT IN (SELECT DISTINCT \"U_DocEntry\" FROM \"@HCO_WT1100\" WHERE \"U_DocType\" = 19) AND \"ObjType\" = 19 AND \"DocEntry\" IN (SELECT DISTINCT \"AbsEntry\" FROM RPC5) UNION ALL SELECT \"DocEntry\", \"DocNum\" AS \"Numero\", \"CardCode\" AS \"Socio de Negocio\", 'Factura de clientes' AS \"Documento\", \"DocTotal\", \"ObjType\" AS \"DocType\", \"DocDate\" AS \"Fecha\"  FROM OINV WHERE \"DocEntry\" NOT IN (SELECT DISTINCT \"U_DocEntry\" FROM \"@HCO_WT1100\"  WHERE \"U_DocType\" = 13) AND \"ObjType\"=13 AND \"DocEntry\" IN (SELECT DISTINCT \"AbsEntry\" FROM INV5) UNION ALL SELECT \"DocEntry\", \"DocNum\" AS \"Numero\", \"CardCode\" AS \"Socio de Negocio\", 'Nota crédito clientes' AS \"Documento\", \"DocTotal\", \"ObjType\" AS \"DocType\", \"DocDate\" AS \"Fecha\"  FROM ORIN WHERE \"DocEntry\" NOT IN(SELECT DISTINCT \"U_DocEntry\" FROM \"@HCO_WT1100\" WHERE \"U_DocType\" = 14) AND \"ObjType\" = 14 AND \"DocEntry\" IN (SELECT DISTINCT \"AbsEntry\" FROM RIN5)) AS R ORDER BY \"Fecha\", \"Documento\",\"Numero\""
    },
    {
      "QueryName": "GetThirdMissingReference",
      "Query": "SELECT Y0.\"TransId\", Y0.\"CardCode\", Y2.\"Code\" FROM ( SELECT T0.\"TransId\", ( CASE CAST(T0.\"TransType\" AS NVARCHAR) WHEN '1470000049' THEN (SELECT CASE WHEN CAST(TCAP.\"TransType\" AS NVARCHAR) = 18 THEN (SELECT TFAC.\"CardCode\" FROM opch TFAC WHERE TFAC.\"DocEntry\" = TCAP.\"CreatedBy\") WHEN CAST(TCAP.\"TransType\" AS NVARCHAR) = 1470000049 THEN (SELECT TFAC.\"CardCode\" FROM opch TFAC WHERE TFAC.\"DocEntry\" = ifnull(TCAP.\"DocEntry\", 0)) ELSE '' END FROM oacq TCAP WHERE TCAP.\"DocEntry\" = T0.\"CreatedBy\" ) WHEN '15' THEN (SELECT TA.\"CardCode\" FROM odln TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '16' THEN (SELECT TA.\"CardCode\" FROM ordn TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '203' THEN (SELECT TA.\"CardCode\" FROM odpi TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '13' THEN (SELECT TA.\"CardCode\" FROM oinv TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '14' THEN (SELECT TA.\"CardCode\" FROM orin TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '132' THEN (SELECT TA.\"CardCode\" FROM oinv TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '20' THEN (SELECT TA.\"CardCode\" FROM opdn TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '21' THEN (SELECT TA.\"CardCode\" FROM orpd TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '204' THEN (SELECT TA.\"CardCode\" FROM odpo TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '18' THEN (SELECT TA.\"CardCode\" FROM opch TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '19' THEN (SELECT TA.\"CardCode\" FROM orpc TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '69' THEN (SELECT TA.\"CardCode\" FROM oipf TA WHERE TA.\"JdtNum\" = T0.\"TransId\") WHEN '163' THEN (SELECT TA.\"CardCode\" FROM opch TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '24' THEN (SELECT TA.\"CardCode\" FROM orct TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '25' THEN '' WHEN '46' THEN (SELECT TA.\"CardCode\" FROM ovpm TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '57' THEN (CASE ifnull((SELECT TA.\"VendorCode\" FROM ocho TA WHERE TA.\"TransNum\" = T0.\"TransId\"), '') WHEN '' THEN (SELECT TA.\"VendorCode\" FROM ocho TA WHERE TA.\"CheckKey\" = T0.\"CreatedBy\") ELSE (SELECT TA.\"VendorCode\" FROM ocho TA WHERE TA.\"TransNum\" = T0.\"TransId\") END) WHEN '76' THEN '' WHEN '-2' THEN (CASE WHEN T1.\"ShortName\" = T1.\"Account\" THEN '' ELSE T1.\"ShortName\" END) WHEN '-3' THEN (CASE WHEN T1.\"ShortName\" = T1.\"Account\" THEN '' ELSE T1.\"ShortName\" END) WHEN '58' THEN '' WHEN '59' THEN '' WHEN '60' THEN '' WHEN '67' THEN (SELECT TA.\"CardCode\" FROM owtr TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '30' THEN (CASE (SELECT TM.\"LocManTran\" FROM oact TM WHERE TM.\"AcctCode\" = T1.\"Account\") WHEN 'Y' THEN T1.\"ShortName\" ELSE null END) WHEN '202' THEN '' WHEN '162' THEN '' WHEN '10000071' THEN '' WHEN '321' THEN T1.\"ShortName\" WHEN '-5' THEN (CASE WHEN T1.\"ShortName\" = T1.\"Account\" THEN '' ELSE T1.\"ShortName\" END) ELSE (CASE WHEN T1.\"ShortName\" = T1.\"Account\" THEN '' ELSE T1.\"ShortName\" END) END ) AS \"CardCode\" FROM OJDT T0 INNER JOIN JDT1 T1 ON T0.\"TransId\" = T1.\"TransId\" WHERE (T1.\"U_HCO_RELPAR\" IS NULL OR T1.\"U_HCO_RELPAR\" = '') ) Y0 INNER JOIN \"@HCO_RP1101\" Y1 ON Y0.\"CardCode\" = Y1.\"U_CardCode\" INNER JOIN \"@HCO_RP1100\" Y2 ON Y1.\"Code\" = Y2.\"Code\" GROUP BY Y0.\"TransId\", Y0.\"CardCode\", Y2.\"Code\""
    },
    {
      "QueryName": "GetReceiptFromInvoice",
      "Query": "SELECT (CASE '{0}' WHEN 13 THEN (SELECT \"ReceiptNum\" FROM OINV WHERE \"DocEntry\" = '{1}') WHEN 18 THEN (SELECT \"ReceiptNum\" FROM OPCH WHERE \"DocEntry\" = '{1}') WHEN 203 THEN (SELECT \"ReceiptNum\" FROM ODPI WHERE \"DocEntry\" = '{1}') WHEN 204 THEN (SELECT \"ReceiptNum\" FROM ODPO WHERE \"DocEntry\" = '{1}') END) AS \"Receipt\", (CASE WHEN '{0}' IN ('13','203') THEN '24' WHEN '{0}' IN ('18','204') THEN '46' END) AS \"ObjType\", (CASE '{0}' WHEN 13 THEN (SELECT \"TransId\" FROM ORCT WHERE \"DocEntry\" = (SELECT \"ReceiptNum\" FROM OINV WHERE \"DocEntry\" = '{1}')) WHEN 18 THEN (SELECT \"TransId\" FROM OVPM WHERE \"DocEntry\" = (SELECT \"ReceiptNum\" FROM OPCH WHERE \"DocEntry\" = '{1}')) WHEN 203 THEN (SELECT \"TransId\" FROM ORCT WHERE \"DocEntry\" = (SELECT \"ReceiptNum\" FROM ODPI WHERE \"DocEntry\" = '{1}')) WHEN 204 THEN (SELECT \"TransId\" FROM OVPM WHERE \"DocEntry\" = (SELECT \"ReceiptNum\" FROM ODPO WHERE \"DocEntry\" = '{1}')) END) AS \"PaymentJournal\" FROM DUMMY"
    },
    {
      "QueryName": "GetSelfWithHoldingTax",
      "Query": "SELECT V0.\"Code\", V0.\"U_DebitAcct\", V0.\"U_CreditAcct\", V0.\"U_Rate\", V1.\"U_Type\", V0.\"Base\", V0.\"Retencion\" FROM ( SELECT X0.\"Code\", X0.\"U_DebitAcct\", X0.\"U_CreditAcct\", X0.\"U_Rate\", SUM(\"Base\") AS \"Base\", SUM(\"Retencion\") AS \"Retencion\" FROM ( SELECT Y0.\"Code\", Y0.\"U_DebitAcct\", Y0.\"U_CreditAcct\", Y0.\"U_Rate\", SUM(\"LineTotal\") AS \"Base\", (SUM(\"LineTotal\") * Y0.\"U_Rate\" / 100) \"Retencion\" FROM ( SELECT T0.\"Code\", T0.\"U_DebitAcct\", T0.\"U_CreditAcct\", T0.\"U_Rate\", T3.\"LineTotal\", T0.\"U_MinAmnt\" FROM \"@HCO_SW0100\" T0 INNER JOIN \"@HCO_SW0101\" T1 ON T0.\"Code\" = T1.\"Code\" AND T1.\"U_Exclude\" = 'N' INNER JOIN OITM T2 ON T1.\"U_ItmsGrpCod\" = T2.\"ItmsGrpCod\" INNER JOIN INV1 T3 ON T2.\"ItemCode\" = T3.\"ItemCode\" AND T3.\"DocEntry\" = '{0}' INNER JOIN OINV T4 ON T3.\"DocEntry\" = T4.\"DocEntry\" INNER JOIN \"@HCO_RP1101\" T5 ON T4.\"CardCode\" = T5.\"U_CardCode\" INNER JOIN \"@HCO_RP1100\" T6 ON T5.\"Code\" = T6.\"Code\" AND IFNULL(T6.\"U_TaxCardTypeID\", '') != IFNULL(T0.\"U_TaxCardTypeID\", '') WHERE T3.\"ItemCode\" NOT IN (SELECT J0.\"U_ItemCode\" FROM \"@HCO_SW0102\" J0 WHERE IFNULL(J0.\"U_ItemCode\",'') <> '' AND J0.\"Code\" = T0.\"Code\" GROUP BY J0.\"Code\", J0.\"U_ItemCode\") AND T0.\"U_Enabled\" = 'Y' AND T4.\"CardCode\" NOT IN (SELECT IFNULL(S0.\"U_CardCode\",'-1') FROM \"@HCO_SW0103\" S0 WHERE S0.\"Code\" = T0.\"Code\") AND T0.\"U_Type\" IN ({1}) AND T0.\"U_Rate\" > 0 AND T3.\"LineTotal\" >= T0.\"U_MinAmnt\" ) Y0 GROUP BY Y0.\"Code\", Y0.\"U_DebitAcct\", Y0.\"U_CreditAcct\", Y0.\"U_Rate\", Y0.\"U_MinAmnt\" HAVING SUM(\"LineTotal\") >= Y0.\"U_MinAmnt\" UNION SELECT Y0.\"Code\", Y0.\"U_DebitAcct\", Y0.\"U_CreditAcct\", Y0.\"U_Rate\", SUM(\"LineTotal\") AS \"Base\", (SUM(\"LineTotal\") * Y0.\"U_Rate\" / 100) \"Retencion\" FROM ( SELECT T0.\"Code\", T0.\"U_DebitAcct\", T0.\"U_CreditAcct\", T0.\"U_Rate\", T3.\"LineTotal\", T0.\"U_MinAmnt\" FROM \"@HCO_SW0100\" T0 INNER JOIN \"@HCO_SW0102\" T7 ON T0.\"Code\" = T7.\"Code\" AND T0.\"U_ItemAction\" = 'I' INNER JOIN INV1 T3 ON T3.\"ItemCode\" = T7.\"U_ItemCode\" AND T3.\"DocEntry\" = '{0}' INNER JOIN OINV T4 ON T3.\"DocEntry\" = T4.\"DocEntry\" INNER JOIN \"@HCO_RP1101\" T5 ON T4.\"CardCode\" = T5.\"U_CardCode\" INNER JOIN \"@HCO_RP1100\" T6 ON T5.\"Code\" = T6.\"Code\" AND IFNULL(T6.\"U_TaxCardTypeID\", '') != IFNULL(T0.\"U_TaxCardTypeID\", '') WHERE T0.\"U_Enabled\" = 'Y' AND T4.\"CardCode\" NOT IN (SELECT IFNULL(S0.\"U_CardCode\",'-1') FROM \"@HCO_SW0103\" S0 WHERE S0.\"Code\" = T0.\"Code\") AND T0.\"U_Type\" IN ({1}) AND T0.\"U_Rate\" > 0 AND T3.\"LineTotal\" >= T0.\"U_MinAmnt\" ) Y0 GROUP BY Y0.\"Code\", Y0.\"U_DebitAcct\", Y0.\"U_CreditAcct\", Y0.\"U_Rate\", Y0.\"U_MinAmnt\" HAVING SUM(\"LineTotal\") >= Y0.\"U_MinAmnt\" ) X0 GROUP BY X0.\"Code\", X0.\"U_DebitAcct\", X0.\"U_CreditAcct\", X0.\"U_Rate\" ) V0 INNER JOIN \"@HCO_SW0100\" V1 ON V0.\"Code\" = V1.\"Code\""
    },
    {
      "QueryName": "GetSelfWithHoldingTaxNC",
      "Query": "SELECT V0.\"Code\", V0.\"U_DebitAcct\", V0.\"U_CreditAcct\", V0.\"U_Rate\", V1.\"U_Type\", V0.\"Base\", V0.\"Retencion\" FROM ( SELECT X0.\"Code\", X0.\"U_DebitAcct\", X0.\"U_CreditAcct\", X0.\"U_Rate\", SUM(\"Base\") AS \"Base\", SUM(\"Retencion\") AS \"Retencion\" FROM ( SELECT Y0.\"Code\", Y0.\"U_DebitAcct\", Y0.\"U_CreditAcct\", Y0.\"U_Rate\", SUM(\"LineTotal\") AS \"Base\", (SUM(\"LineTotal\") * Y0.\"U_Rate\" / 100) \"Retencion\" FROM ( SELECT T0.\"Code\", T0.\"U_DebitAcct\", T0.\"U_CreditAcct\", T0.\"U_Rate\", T3.\"LineTotal\", T0.\"U_MinAmnt\" FROM \"@HCO_SW0100\" T0 INNER JOIN \"@HCO_SW0101\" T1 ON T0.\"Code\" = T1.\"Code\" AND T1.\"U_Exclude\" = 'N' INNER JOIN OITM T2 ON T1.\"U_ItmsGrpCod\" = T2.\"ItmsGrpCod\" INNER JOIN RIN1 T3 ON T2.\"ItemCode\" = T3.\"ItemCode\" AND T3.\"DocEntry\" = '{0}' INNER JOIN ORIN T4 ON T3.\"DocEntry\" = T4.\"DocEntry\" INNER JOIN \"@HCO_RP1101\" T5 ON T4.\"CardCode\" = T5.\"U_CardCode\" INNER JOIN \"@HCO_RP1100\" T6 ON T5.\"Code\" = T6.\"Code\" AND IFNULL(T6.\"U_TaxCardTypeID\", '') != IFNULL(T0.\"U_TaxCardTypeID\", '') WHERE T3.\"ItemCode\" NOT IN (SELECT J0.\"U_ItemCode\" FROM \"@HCO_SW0102\" J0 WHERE IFNULL(J0.\"U_ItemCode\",'') <> '' AND J0.\"Code\" = T0.\"Code\" GROUP BY J0.\"Code\", J0.\"U_ItemCode\") AND T0.\"U_Enabled\" = 'Y' AND T4.\"CardCode\" NOT IN (SELECT IFNULL(S0.\"U_CardCode\",'-1') FROM \"@HCO_SW0103\" S0 WHERE S0.\"Code\" = T0.\"Code\") AND T0.\"U_Type\" IN ({1}) AND T0.\"U_Rate\" > 0 AND T3.\"LineTotal\" >= T0.\"U_MinAmnt\" ) Y0 GROUP BY Y0.\"Code\", Y0.\"U_DebitAcct\", Y0.\"U_CreditAcct\", Y0.\"U_Rate\", Y0.\"U_MinAmnt\" HAVING SUM(\"LineTotal\") >= Y0.\"U_MinAmnt\" UNION SELECT Y0.\"Code\", Y0.\"U_DebitAcct\", Y0.\"U_CreditAcct\", Y0.\"U_Rate\", SUM(\"LineTotal\") AS \"Base\", (SUM(\"LineTotal\") * Y0.\"U_Rate\" / 100) \"Retencion\" FROM ( SELECT T0.\"Code\", T0.\"U_DebitAcct\", T0.\"U_CreditAcct\", T0.\"U_Rate\", T3.\"LineTotal\", T0.\"U_MinAmnt\" FROM \"@HCO_SW0100\" T0 INNER JOIN \"@HCO_SW0102\" T7 ON T0.\"Code\" = T7.\"Code\" AND T0.\"U_ItemAction\" = 'I' INNER JOIN RIN1 T3 ON T3.\"ItemCode\" = T7.\"U_ItemCode\" AND T3.\"DocEntry\" = '{0}' INNER JOIN ORIN T4 ON T3.\"DocEntry\" = T4.\"DocEntry\" INNER JOIN \"@HCO_RP1101\" T5 ON T4.\"CardCode\" = T5.\"U_CardCode\" INNER JOIN \"@HCO_RP1100\" T6 ON T5.\"Code\" = T6.\"Code\" AND IFNULL(T6.\"U_TaxCardTypeID\", '') != IFNULL(T0.\"U_TaxCardTypeID\", '') WHERE T0.\"U_Enabled\" = 'Y' AND T4.\"CardCode\" NOT IN (SELECT IFNULL(S0.\"U_CardCode\",'-1') FROM \"@HCO_SW0103\" S0 WHERE S0.\"Code\" = T0.\"Code\") AND T0.\"U_Type\" IN ({1}) AND T0.\"U_Rate\" > 0 AND T3.\"LineTotal\" >= T0.\"U_MinAmnt\" ) Y0 GROUP BY Y0.\"Code\", Y0.\"U_DebitAcct\", Y0.\"U_CreditAcct\", Y0.\"U_Rate\", Y0.\"U_MinAmnt\" HAVING SUM(\"LineTotal\") >= Y0.\"U_MinAmnt\" ) X0 GROUP BY X0.\"Code\", X0.\"U_DebitAcct\", X0.\"U_CreditAcct\", X0.\"U_Rate\" ) V0 INNER JOIN \"@HCO_SW0100\" V1 ON V0.\"Code\" = V1.\"Code\""
    },
    {
      "QueryName": "GetWitholdingRegistered",
      "Query": "SELECT \"DocNum\" AS \"Nro Reg. Retencion\", \"DocEntry\", (CASE \"U_OpType\" WHEN '1' THEN 'Contabilizacion' WHEN '2' THEN 'Reclasificacion' WHEN '3' THEN 'Cancelacion' END) AS \"Tipo Operacion\", (CASE \"U_TipReg\" WHEN '1' THEN 'Retencion' WHEN '2' THEN 'Autorretencion' END) AS \"Tipo de Registro\", \"U_RlPyCode\" as \"Tercero\", \"U_TransId\" as \"Asiento\" FROM \"@HCO_WT1100\" WHERE \"U_DocType\"='{0}' AND \"U_DocEntry\" ='{1}'"
    }
  ]
}
