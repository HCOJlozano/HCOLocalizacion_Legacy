{
  "Queries": 
  [
    {
      "QueryName": "CheckLastHourExecution",
      "Query": "SELECT (CASE WHEN \"U_HCO_LastTimeExec\" IS NULL THEN '1' WHEN IFNULL(ROUND(SECONDS_BETWEEN( TO_TIME((CASE WHEN LENGTH(\"U_HCO_LastTimeExec\") = 3 THEN TO_NVARCHAR(CONCAT('0',\"U_HCO_LastTimeExec\")) ELSE TO_NVARCHAR(\"U_HCO_LastTimeExec\") END),'HHMI'), ADD_SECONDS(CURRENT_TIME, -60))/60, 0),0) > \"U_HCO_TimeExec\" THEN '0' ELSE '1' END) AS \"Result\" FROM \"@HCO_TS0001\" WHERE \"Code\" = '{0}'"
    },
    {
      "QueryName": "GetMissingOperations",
      "Query": "SELECT ROW_NUMBER() OVER (ORDER BY \"DocEntry\") AS \"LineId\", 'Y' AS \"Seleccionar\", * FROM ( SELECT \"DocEntry\", \"DocNum\" AS \"Numero\", \"CardCode\", 'Factura Proveedor' AS \"Documento\", \"DocTotal\", \"ObjType\" AS \"DocType\"  FROM OPCH WHERE \"DocEntry\" NOT IN ( SELECT DISTINCT \"U_DocEntry\" FROM \"@HCO_WT1100\" WHERE \"U_DocType\" = 18) AND \"ObjType\"=18 AND \"DocEntry\" IN (SELECT DISTINCT \"AbsEntry\" FROM PCH5) UNION ALL SELECT \"DocEntry\", \"DocNum\" AS \"Numero\", \"CardCode\" AS \"Socio de Negocio\", 'NC Factura Proveedor' AS \"Documento\", \"DocTotal\", \"ObjType\" AS \"DocType\" FROM ORPC WHERE \"DocEntry\" NOT IN (SELECT DISTINCT \"U_DocEntry\" FROM \"@HCO_WT1100\" WHERE \"U_DocType\" = 19) AND \"ObjType\" = 19 AND \"DocEntry\" IN (SELECT DISTINCT \"AbsEntry\" FROM RPC5) UNION ALL SELECT \"DocEntry\", \"DocNum\" AS \"Numero\", \"CardCode\" AS \"Socio de Negocio\", 'Factura de clientes' AS \"Documento\", \"DocTotal\", \"ObjType\" AS \"DocType\"  FROM OINV WHERE \"DocEntry\" NOT IN (SELECT DISTINCT \"U_DocEntry\" FROM \"@HCO_WT1100\"  WHERE \"U_DocType\" = 13) AND \"ObjType\"=13 AND \"DocEntry\" IN (SELECT DISTINCT \"AbsEntry\" FROM INV5) UNION ALL SELECT \"DocEntry\", \"DocNum\" AS \"Numero\", \"CardCode\" AS \"Socio de Negocio\", 'Nota crédito clientes' AS \"Documento\", \"DocTotal\", \"ObjType\" AS \"DocType\"  FROM ORIN WHERE \"DocEntry\" NOT IN(SELECT DISTINCT \"U_DocEntry\" FROM \"@HCO_WT1100\" WHERE \"U_DocType\" = 14) AND \"ObjType\" = 14 AND \"DocEntry\" IN (SELECT DISTINCT \"AbsEntry\" FROM RIN5)) AS R ORDER BY \"Documento\",\"Numero\""
    },
    {
      "QueryName": "GetThirdMissingReference",
      "Query": "SELECT Y0.\"TransId\", Y0.\"CardCode\", Y2.\"Code\" FROM ( SELECT T0.\"TransId\", ( CASE CAST(T0.\"TransType\" AS NVARCHAR) WHEN '1470000049' THEN (SELECT CASE WHEN CAST(TCAP.\"TransType\" AS NVARCHAR) = 18 THEN (SELECT TFAC.\"CardCode\" FROM opch TFAC WHERE TFAC.\"DocEntry\" = TCAP.\"CreatedBy\") WHEN CAST(TCAP.\"TransType\" AS NVARCHAR) = 1470000049 THEN (SELECT TFAC.\"CardCode\" FROM opch TFAC WHERE TFAC.\"DocEntry\" = ifnull(TCAP.\"DocEntry\", 0)) ELSE '' END FROM oacq TCAP WHERE TCAP.\"DocEntry\" = T0.\"CreatedBy\" ) WHEN '15' THEN (SELECT TA.\"CardCode\" FROM odln TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '16' THEN (SELECT TA.\"CardCode\" FROM ordn TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '203' THEN (SELECT TA.\"CardCode\" FROM odpi TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '13' THEN (SELECT TA.\"CardCode\" FROM oinv TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '14' THEN (SELECT TA.\"CardCode\" FROM orin TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '132' THEN (SELECT TA.\"CardCode\" FROM oinv TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '20' THEN (SELECT TA.\"CardCode\" FROM opdn TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '21' THEN (SELECT TA.\"CardCode\" FROM orpd TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '204' THEN (SELECT TA.\"CardCode\" FROM odpo TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '18' THEN (SELECT TA.\"CardCode\" FROM opch TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '19' THEN (SELECT TA.\"CardCode\" FROM orpc TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '69' THEN (SELECT TA.\"CardCode\" FROM oipf TA WHERE TA.\"JdtNum\" = T0.\"TransId\") WHEN '163' THEN (SELECT TA.\"CardCode\" FROM opch TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '24' THEN (SELECT TA.\"CardCode\" FROM orct TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '25' THEN '' WHEN '46' THEN (SELECT TA.\"CardCode\" FROM ovpm TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '57' THEN (CASE ifnull((SELECT TA.\"VendorCode\" FROM ocho TA WHERE TA.\"TransNum\" = T0.\"TransId\"), '') WHEN '' THEN (SELECT TA.\"VendorCode\" FROM ocho TA WHERE TA.\"CheckKey\" = T0.\"CreatedBy\") ELSE (SELECT TA.\"VendorCode\" FROM ocho TA WHERE TA.\"TransNum\" = T0.\"TransId\") END) WHEN '76' THEN '' WHEN '-2' THEN (CASE WHEN T1.\"ShortName\" = T1.\"Account\" THEN '' ELSE T1.\"ShortName\" END) WHEN '-3' THEN (CASE WHEN T1.\"ShortName\" = T1.\"Account\" THEN '' ELSE T1.\"ShortName\" END) WHEN '58' THEN '' WHEN '59' THEN '' WHEN '60' THEN '' WHEN '67' THEN (SELECT TA.\"CardCode\" FROM owtr TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '30' THEN (CASE (SELECT TM.\"LocManTran\" FROM oact TM WHERE TM.\"AcctCode\" = T1.\"Account\") WHEN 'Y' THEN T1.\"ShortName\" ELSE null END) WHEN '202' THEN '' WHEN '162' THEN '' WHEN '10000071' THEN '' WHEN '321' THEN T1.\"ShortName\" WHEN '-5' THEN (CASE WHEN T1.\"ShortName\" = T1.\"Account\" THEN '' ELSE T1.\"ShortName\" END) ELSE (CASE WHEN T1.\"ShortName\" = T1.\"Account\" THEN '' ELSE T1.\"ShortName\" END) END ) AS \"CardCode\" FROM OJDT T0 INNER JOIN JDT1 T1 ON T0.\"TransId\" = T1.\"TransId\" WHERE (T1.\"U_HCO_RELPAR\" IS NULL OR T1.\"U_HCO_RELPAR\" = '') ) Y0 INNER JOIN \"@HCO_RP1101\" Y1 ON Y0.\"CardCode\" = Y1.\"U_CardCode\" INNER JOIN \"@HCO_RP1100\" Y2 ON Y1.\"Code\" = Y2.\"Code\" GROUP BY Y0.\"TransId\", Y0.\"CardCode\", Y2.\"Code\""
    },
    {
      "QueryName": "GetReceiptFromInvoice",
      "Query": "SELECT (CASE '{0}' WHEN 13 THEN (SELECT \"ReceiptNum\" FROM OINV WHERE \"DocEntry\" = '{1}') WHEN 18 THEN (SELECT \"ReceiptNum\" FROM OPCH WHERE \"DocEntry\" = '{1}') WHEN 203 THEN (SELECT \"ReceiptNum\" FROM ODPI WHERE \"DocEntry\" = '{1}') WHEN 204 THEN (SELECT \"ReceiptNum\" FROM ODPO WHERE \"DocEntry\" = '{1}') END) AS \"Receipt\", (CASE WHEN '{0}' IN ('13','203') THEN '24' WHEN '{0}' IN ('18','204') THEN '46' END) AS \"ObjType\" FROM DUMMY"
    }
  ]
}
