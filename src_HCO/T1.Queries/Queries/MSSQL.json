{
  "Queries": 
  [
    {
      "QueryName": "GetThirdMissingReference",
      "Query": "SELECT Y0.\"TransId\", Y0.\"CardCode\", Y2.\"Code\" FROM ( SELECT T0.\"TransId\", ( CASE CAST(T0.\"TransType\" AS NVARCHAR) WHEN '1470000049' THEN (SELECT CASE WHEN CAST(TCAP.\"TransType\" AS NVARCHAR) = 18 THEN (SELECT TFAC.\"CardCode\" FROM opch TFAC WHERE TFAC.\"DocEntry\" = TCAP.\"CreatedBy\") WHEN CAST(TCAP.\"TransType\" AS NVARCHAR) = 1470000049 THEN (SELECT TFAC.\"CardCode\" FROM opch TFAC WHERE TFAC.\"DocEntry\" = ISNULL(TCAP.\"DocEntry\", 0)) ELSE '' END FROM oacq TCAP WHERE TCAP.\"DocEntry\" = T0.\"CreatedBy\" ) WHEN '15' THEN (SELECT TA.\"CardCode\" FROM odln TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '16' THEN (SELECT TA.\"CardCode\" FROM ordn TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '203' THEN (SELECT TA.\"CardCode\" FROM odpi TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '13' THEN (SELECT TA.\"CardCode\" FROM oinv TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '14' THEN (SELECT TA.\"CardCode\" FROM orin TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '132' THEN (SELECT TA.\"CardCode\" FROM oinv TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '20' THEN (SELECT TA.\"CardCode\" FROM opdn TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '21' THEN (SELECT TA.\"CardCode\" FROM orpd TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '204' THEN (SELECT TA.\"CardCode\" FROM odpo TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '18' THEN (SELECT TA.\"CardCode\" FROM opch TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '19' THEN (SELECT TA.\"CardCode\" FROM orpc TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '69' THEN (SELECT TA.\"CardCode\" FROM oipf TA WHERE TA.\"JdtNum\" = T0.\"TransId\") WHEN '163' THEN (SELECT TA.\"CardCode\" FROM opch TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '24' THEN (SELECT TA.\"CardCode\" FROM orct TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '25' THEN '' WHEN '46' THEN (SELECT TA.\"CardCode\" FROM ovpm TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '57' THEN (CASE ISNULL((SELECT TA.\"VendorCode\" FROM ocho TA WHERE TA.\"TransNum\" = T0.\"TransId\"), '') WHEN '' THEN (SELECT TA.\"VendorCode\" FROM ocho TA WHERE TA.\"CheckKey\" = T0.\"CreatedBy\") ELSE (SELECT TA.\"VendorCode\" FROM ocho TA WHERE TA.\"TransNum\" = T0.\"TransId\") END) WHEN '76' THEN '' WHEN '-2' THEN (CASE WHEN T1.\"ShortName\" = T1.\"Account\" THEN '' ELSE T1.\"ShortName\" END) WHEN '-3' THEN (CASE WHEN T1.\"ShortName\" = T1.\"Account\" THEN '' ELSE T1.\"ShortName\" END) WHEN '58' THEN '' WHEN '59' THEN '' WHEN '60' THEN '' WHEN '67' THEN (SELECT TA.\"CardCode\" FROM owtr TA WHERE TA.\"DocEntry\" = T0.\"CreatedBy\") WHEN '30' THEN (CASE (SELECT TM.\"LocManTran\" FROM oact TM WHERE TM.\"AcctCode\" = T1.\"Account\") WHEN 'Y' THEN T1.\"ShortName\" ELSE null END) WHEN '202' THEN '' WHEN '162' THEN '' WHEN '10000071' THEN '' WHEN '321' THEN T1.\"ShortName\" WHEN '-5' THEN (CASE WHEN T1.\"ShortName\" = T1.\"Account\" THEN '' ELSE T1.\"ShortName\" END) ELSE (CASE WHEN T1.\"ShortName\" = T1.\"Account\" THEN '' ELSE T1.\"ShortName\" END) END ) AS \"CardCode\" FROM OJDT T0 INNER JOIN JDT1 T1 ON T0.\"TransId\" = T1.\"TransId\" WHERE (T1.\"U_HCO_RELPAR\" IS NULL OR T1.\"U_HCO_RELPAR\" = '') ) Y0 INNER JOIN \"@HCO_RP1101\" Y1 ON Y0.\"CardCode\" = Y1.\"U_CardCode\" INNER JOIN \"@HCO_RP1100\" Y2 ON Y1.\"Code\" = Y2.\"Code\" GROUP BY Y0.\"TransId\", Y0.\"CardCode\", Y2.\"Code\""
    }
  ]
}
